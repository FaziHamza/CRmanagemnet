<nz-spin [nzSpinning]="saveLoader" [nzSize]="'large'">
    <div class="content-body-inner" *ngIf="orderDetail && !isPrintShow">
        <div class="row heading-box">
            <div class="col-lg-6">
                <span class="head-title">{{"Promissory_Notes.Date" | translate}}Date: </span>
                <span class="head-detail" *ngIf="orderDetail && orderDetail.orderDate">{{orderDetail?.orderDate |
                    date:'dd MMMyyyy'}}</span>
                <span class="head-detail" *ngIf="!orderDetail.orderId">---</span>
            </div>
            <div class="col-lg-6 ">
                <div class="text-end">
                    <h1 class="head-title ">{{"Promissory_Notes.Order_No" | translate}}:
                        <span class="head-detail" *ngIf="orderDetail?.orderId">{{orderDetail?.orderId}}</span>
                        <span class="head-detail" *ngIf="!orderDetail.orderId">---</span>
                    </h1>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-heading">
                <div class="head-left">
                    <h5 class="card-subheading">{{"Promissory_Notes.Order_Detail" | translate}}</h5>
                </div>
                <div class="head-right header-btn-setup">
                    <button class="btn btn-round mb-2"
                        [style.background-color]="orderDetail && orderDetail.statusObj?.lookupBGColor"
                        [style.color]="orderDetail && orderDetail.statusObj?.lookupTextColor" type="button">
                        <span
                            *ngIf="orderDetail && orderDetail.statusObj">{{orderDetail.statusObj?.translations[0].lookupName}}</span>
                        <span *ngIf="!orderDetail.statusObj">---</span>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <div class="row">
                    <div class="col-lg-2">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Order_Link" | translate}}</h4>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card-box">
                            <a class="anchor-content" *ngIf="orderDetail && orderDetail.orderQNTRLLink"
                            href="{{ orderDetail.orderQNTRLLink }}" target="_blank">{{ orderDetail.orderQNTRLLink }}</a>                         
                            <a class="anchor-content" *ngIf="!orderDetail.orderQNTRLLink">---</a>
                        </div>
                    </div>
                    <div class="col-lg-6 text-end">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Opportunity_Card_No" | translate}}. :
                                <span class="detail"
                                    *ngIf="orderDetail && orderDetail.opportunityNo">{{orderDetail.opportunityNo}}</span>
                                <span class="detail" *ngIf="!orderDetail.opportunityNo">---</span>
                            </h4>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Brand_Name" | translate}}</h4>
                            <h4 class="detail" *ngIf="orderDetail && orderDetail.orderDetail?.brand">
                                {{orderDetail.orderDetail?.brand.brand}}</h4>
                            <h4 class="detail" *ngIf="!orderDetail.orderDetail?.brand">---</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Vehicle_Model" | translate}}</h4>
                            <h4 class="detail" *ngIf="orderDetail && orderDetail.orderDetail?.model">
                                {{orderDetail.orderDetail?.model.modelName}}</h4>
                            <h4 class="detail" *ngIf="!orderDetail.orderDetail?.model">---</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.VIN_No" | translate}}.</h4>
                            <h4 class="detail" *ngIf="orderDetail && orderDetail.orderDetail?.vinNo">
                                {{orderDetail.orderDetail?.vinNo}}</h4>
                            <h4 class="detail" *ngIf="!orderDetail.orderDetail?.vinNo">---</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Vehicle_Price" | translate}}</h4>
                            <h4 class="detail" *ngIf="orderDetail && orderDetail.totalAmount">
                                {{orderDetail.totalAmount | customRound: 0}} JD</h4>
                            <h4 class="detail" *ngIf="!orderDetail.totalAmount">---</h4>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4">
                        <div class="card-box">
                            <h4 class="title">{{"Promissory_Notes.Sales_Person" | translate}}</h4>
                            <h4 class="detail" *ngIf="orderDetail && orderDetail.salesConsultant.salesConsultantName">
                                {{orderDetail.salesConsultant.salesConsultantName}}</h4>
                            <h4 class="detail" *ngIf="!orderDetail.salesConsultant">---</h4>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <nz-tabset>
            <nz-tab [nzTitle]="titleTemplate">
                <ng-template #titleTemplate>
                    {{"Promissory_Notes.PN_V1" | translate}}
                </ng-template>
                <div class="row">
                    <div class="col-lg-4 col-md-6">
                        <div class="card">
                            <div class="card-heading bb-none">
                                <h5>{{"Promissory_Notes.Customer_Information" | translate}}</h5>
                            </div>
                            <div class="card-content">
                                <div class="profileee">

                                    <div class="img-box" *ngIf="orderDetail.customer.customerName">
                                        <nz-avatar
                                            [nzText]="commonService.getInitialOfName(orderDetail.customer.customerName)"></nz-avatar>
                                    </div>
                                    <div class="heading-box">
                                        <p class="head-title ">{{"Promissory_Notes.Name" | translate}}
                                            <span class="head-detail"
                                                *ngIf="orderDetail && orderDetail.customer.customerName">{{orderDetail.customer.customerName}}</span>
                                            <span class="head-detail"
                                                *ngIf="!orderDetail.customer.customerName">---</span>
                                        </p>
                                        <p class="head-title ">{{"Promissory_Notes.Customer_Account" | translate}}
                                            <span class="head-detail"
                                                *ngIf="orderDetail && orderDetail.customer.customerId">{{orderDetail.customer.customerId}}</span>
                                            <span class="head-detail"
                                                *ngIf="!orderDetail.customer.customerId">---</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="row heading-box customer-info-card">
                                    <div class="col-lg-4 ">
                                        <p class="head-title ">{{"Promissory_Notes.ID" | translate}}</p>
                                        <p class="head-title ">{{"Promissory_Notes.Phone_No" | translate}}.</p>
                                        <p class="head-title ">{{"Promissory_Notes.Address" | translate}}</p>
                                    </div>
                                    <div class="col-lg-8">
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.customer.nationalId">
                                            {{orderDetail.customer.nationalId}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.customer.nationalId">---</p>
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.customer.mobile">
                                            {{orderDetail.customer.mobile}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.customer.mobile">---</p>
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.customer.custAddress">
                                            {{orderDetail.customer.custAddress}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.customer.custAddress">---</p>
                                    </div>
                                </div>
                                <div class="row heading-box">
                                    <div class="col-lg-4 ">
                                        <p class="head-title ">{{"Promissory_Notes.ID_Attachment" | translate}}</p>
                                    </div>
                                    <div class="col-lg-8">
                                        <button type="button" class="pdf-view-btn"
                                            *ngIf="orderDetail.customer.identityFile1"
                                            (click)="pdfView(orderDetail.customer.identityFile1)">{{"Promissory_Notes.document_name_PDF"
                                            |
                                            translate}}
                                            <a href="" class="eye">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="currentColor"
                                                        d="M12 9a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5c-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0a9.821 9.821 0 0 0-17.64 0Z" />
                                                </svg>
                                            </a>
                                            <a href="" class="download">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="currentColor"
                                                        d="M12 15.575q-.2 0-.375-.062T11.3 15.3l-3.6-3.6q-.275-.275-.275-.7t.275-.7q.275-.275.713-.287t.712.262L11 12.15V5q0-.425.288-.713T12 4q.425 0 .713.288T13 5v7.15l1.875-1.875q.275-.275.713-.263t.712.288q.275.275.275.7t-.275.7l-3.6 3.6q-.15.15-.325.213t-.375.062ZM6 20q-.825 0-1.413-.588T4 18v-2q0-.425.288-.713T5 15q.425 0 .713.288T6 16v2h12v-2q0-.425.288-.713T19 15q.425 0 .713.288T20 16v2q0 .825-.588 1.413T18 20H6Z" />
                                                </svg>
                                            </a>
                                        </button>
                                        <p class="head-detail" *ngIf="!orderDetail.customer.identityFile1">---</p>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="card-heading bb-none">
                                <div class="head-left">
                                    <h5>{{"Promissory_Notes.Guarantor_Information" | translate}}</h5>
                                </div>
                                <!-- <div class="head-right"></div> -->
                            </div>
                            <div class="card-content">
                                <div class="profileee">
                                    <div class="img-box">
                                        <nz-avatar
                                            [nzText]="commonService.getInitialOfName(orderDetail.guarantor.customerName)"></nz-avatar>
                                    </div>
                                    <div class="heading-box">
                                        <p class="head-title ">{{"Promissory_Notes.Name" | translate}}
                                            <span class="head-detail"
                                                *ngIf="orderDetail && orderDetail.guarantor.customerName">{{orderDetail.guarantor.customerName}}</span>
                                            <span class="head-detail"
                                                *ngIf="!orderDetail.guarantor.customerName">---</span>
                                        </p>
                                        <p class="head-title ">{{"Promissory_Notes.Customer_Account" | translate}}
                                            <span *ngIf="orderDetail && orderDetail.guarantor.customerId"
                                                class="head-detail">{{orderDetail.guarantor.customerId}}</span>
                                            <span class="head-detail"
                                                *ngIf="!orderDetail.guarantor.customerId">---</span>
                                        </p>
                                    </div>
                                </div>
                                <div class="row heading-box">
                                    <div class="col-lg-4 ">
                                        <p class="head-title ">{{"Promissory_Notes.ID" | translate}}</p>
                                        <p class="head-title ">{{"Promissory_Notes.Phone_No" | translate}}.</p>
                                        <p class="head-title ">{{"Promissory_Notes.Address" | translate}}</p>
                                    </div>
                                    <div class="col-lg-8">
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.guarantor.nationalId">
                                            {{orderDetail.guarantor.nationalId}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.guarantor.nationalId">---</p>
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.guarantor.mobile">
                                            {{orderDetail.guarantor.mobile}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.guarantor.mobile">---</p>
                                        <p class="head-detail" *ngIf="orderDetail && orderDetail.guarantor.custAddress">
                                            {{orderDetail.guarantor.custAddress}}</p>
                                        <p class="head-detail" *ngIf="!orderDetail.guarantor.custAddress">---</p>
                                    </div>
                                </div>
                                <div class="row heading-box">
                                    <div class="col-lg-4 ">
                                        <p class="head-title ">{{"Promissory_Notes.ID_Attachment" | translate}}</p>
                                    </div>
                                    <div class="col-lg-8">
                                        <button type="button" *ngIf="orderDetail && orderDetail.guarantor.identityFile1"
                                            class="pdf-view-btn">{{"Promissory_Notes.document_name_PDF" |
                                            translate}}
                                            <a href="" class="eye">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="currentColor"
                                                        d="M12 9a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5c-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0a9.821 9.821 0 0 0-17.64 0Z" />
                                                </svg>
                                            </a>
                                            <a href="" class="download">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="currentColor"
                                                        d="M12 15.575q-.2 0-.375-.062T11.3 15.3l-3.6-3.6q-.275-.275-.275-.7t.275-.7q.275-.275.713-.287t.712.262L11 12.15V5q0-.425.288-.713T12 4q.425 0 .713.288T13 5v7.15l1.875-1.875q.275-.275.713-.263t.712.288q.275.275.275.7t-.275.7l-3.6 3.6q-.15.15-.325.213t-.375.062ZM6 20q-.825 0-1.413-.588T4 18v-2q0-.425.288-.713T5 15q.425 0 .713.288T6 16v2h12v-2q0-.425.288-.713T19 15q.425 0 .713.288T20 16v2q0 .825-.588 1.413T18 20H6Z" />
                                                </svg>
                                            </a>
                                        </button>
                                        <p class="head-detail" *ngIf="!orderDetail.guarantor.identityFile1">---</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-8 col-md-8">
                        <div class="promissory-notes-details-card">
                            <div class="card-heading pb-4">
                                <h4>
                                    Promissory Notes Details
                                </h4>
                                <div class="row heading-box" >
                                    <div class="col-lg-4 col-md-6">
                                        <div class="card-box">
                                            <h4 class="head-title">{{"Promissory_Notes.Promissory_Notes_Amount" |
                                                translate}}:
                                                <span class="head-detail"
                                                    *ngIf="orderDetail.pnTotalAmount">{{orderDetail.pnTotalAmount |
                                                    customRound: 0}}</span>
                                                <span class="head-detail" *ngIf="!orderDetail.pnTotalAmount">---</span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-md-6">
                                        <div class="card-box">
                                            <h4 class="head-title">{{"Promissory_Notes.No_Of_Installments" | translate}}
                                                :
                                                <span class="head-detail"
                                                    *ngIf="orderDetail.numberOfInstallments">{{orderDetail.numberOfInstallments}}</span>
                                                <span class="head-detail"
                                                    *ngIf="!orderDetail.numberOfInstallments">---</span>
                                            </h4>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-md-6">
                                        <div class="card-box">
                                            <h4 class="head-title">{{"Promissory_Notes.First_Due_Date" | translate}}:
                                                <span class="head-detail"
                                                    *ngIf="orderDetail.startDate">{{orderDetail.startDate | date:'dd MMM yyyy' }}</span>
                                                <span class="head-detail" *ngIf="!orderDetail.startDate">---</span>
                                            </h4>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="bottom-buttons first-btn mt-4 pt-4" *ngIf="!isGenerate">
                                <button type="button" class="btn btn-white hvr-bounce-to-right2"
                                    [routerLink]="['/home/workorders']">{{"Promissory_Notes.Close" |
                                    translate}}</button>
                                <button class="btn o-btn hvr-bounce-to-right" type="button"
                                    (click)="getListofPromissoryNote()">{{"Promissory_Notes.Generate_PNs_Book" |
                                    translate}}</button>
                            </div>
                            <div class="wizard-form-body" *ngIf="isGenerate">

                                <div class="main-content">
                                    <div class="wizard-form">
                                        <ul id="progressBar" class="progressbar">
                                            <li *ngFor="let step of steps; let i = index" [id]="'progressList-' + (i+1)"
                                                class="d-inline-block fw-bold position-relative text-center float-start progressbar-list"
                                                [ngClass]="{'active': current >= i}">
                                                {{step.title | translate}}
                                            </li>
                                        </ul>

                                    </div>
                                    <nz-spin [nzSpinning]="stepSaveLoader" [nzSize]="'large'">
                                        <div class="wizard-content">
                                            <div *ngFor="let step of steps; let i = index"
                                                class="row justify-content-center" [hidden]="current !== i">
                                                <div class="col-lg-12 col-md-8">
                                                    <div *ngIf="current == 0">
                                                        <div class="row mt-4">
                                                            <div class="col-lg-10"></div>
                                                            <div class="col-lg-2">
                                                                <button type="button"
                                                                    class="btn o-btn hvr-bounce-to-right btn-md rest-btn"
                                                                    (click)="getListofPromissoryNote()"
                                                                    *ngIf="checkReset()">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                        height="24" viewBox="0 0 24 24">
                                                                        <g fill="none" stroke="currentColor"
                                                                            stroke-linecap="round"
                                                                            stroke-linejoin="round" stroke-width="2">
                                                                            <path d="M3 2v6h6" />
                                                                            <path d="M3 13a9 9 0 1 0 3-7.7L3 8" />
                                                                        </g>
                                                                    </svg>
                                                                    {{"Promissory_Notes.Reset" | translate}} </button>
                                                            </div>

                                                        </div>
                                                        <div class="row heading-box">
                                                            <div class="col-lg-6 ">
                                                                <h1 class="header-content ">
                                                                    {{"Promissory_Notes.List_Of_Promissory_Notes" |
                                                                    translate}}
                                                                </h1>

                                                            </div>
                                                            <div class="col-lg-6 text-end">
                                                                <h1 class="header-content ">
                                                                    {{"Promissory_Notes.Difference_amount" |
                                                                    translate}} (JD) : <span
                                                                        class="head-detail">{{differenceAmount}}</span>
                                                                </h1>
                                                            </div>
                                                        </div>
                                                        <div class="table-responsive">

                                                            <nz-table #editRowTable nzBordered [nzData]="promissoryist"
                                                                nzTableLayout="fixed" [nzPageSize]="6">
                                                                <thead>
                                                                    <tr>
                                                                        <th nz-th nzSortFn="simpleSort">
                                                                            {{"Promissory_Notes.No" | translate}}
                                                                        </th>
                                                                        <th> {{"Promissory_Notes.Customer_Name" |
                                                                            translate}}
                                                                        </th>
                                                                        <th nz-th nzSortFn="ascend">
                                                                            {{"Promissory_Notes.Amount" | translate}}
                                                                        </th>
                                                                        <th nz-th nzSortFn="ascend">
                                                                            {{"Promissory_Notes.Due_Date" | translate}}
                                                                        </th>
                                                                        <th nz-th nzSortFn="ascend">
                                                                            {{"Promissory_Notes.PN_Status" | translate}}
                                                                        </th>
                                                                        <th>{{"Promissory_Notes.Action" | translate}}
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr
                                                                        *ngFor="let data of editRowTable.data;let index = index">
                                                                        <ng-container
                                                                            *ngIf="!editCache[data.id].edit; else editTemplate">
                                                                            <td>
                                                                                {{ data.id }}
                                                                            </td>
                                                                            <td>{{ data.customerName }}</td>
                                                                            <td [ngClass]="{
                                                                        'edit-data-status': data.amount != data.orginalAmount
                                                                      }">{{ data.amount | customRound: 3 }} JD
                                                                            </td>
                                                                            <td [ngClass]="{
                                                                            'edit-data-status': data.dueDate != data.originalDueDate
                                                                          }">
                                                                                {{data.dueDate | date: 'dd MMM yyyy'}}
                                                                            </td>
                                                                            <td>

                                                                                <button
                                                                                    class="btn generating-status">Generating</button>
                                                                            </td>
                                                                            <td>
                                                                                <a class="table-edit" *ngIf="!data.edit"
                                                                                    (click)="this.editCache[data.id].edit = true">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                        width="32" height="32"
                                                                                        viewBox="0 0 32 32">
                                                                                        <path fill="currentColor"
                                                                                            d="M2 26h28v2H2zM25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" />
                                                                                    </svg>
                                                                                </a>
                                                                                <a class="table-edit">

                                                                                </a>
                                                                                <button type="button" class="undo-btn"
                                                                                    *ngIf="data.edit"
                                                                                    (click)="undoValue(data.id)">
                                                                                    Undo <svg
                                                                                        xmlns="http://www.w3.org/2000/svg"
                                                                                        width="20" height="20"
                                                                                        viewBox="0 0 24 24">
                                                                                        <path fill="black"
                                                                                            d="M7 19v-2h7.1q1.575 0 2.738-1T18 13.5q0-1.5-1.163-2.5T14.1 10H7.8l2.6 2.6L9 14L4 9l5-5l1.4 1.4L7.8 8h6.3q2.425 0 4.163 1.575T20 13.5q0 2.35-1.738 3.925T14.1 19H7Z" />
                                                                                    </svg>
                                                                                </button>
                                                                            </td>
                                                                        </ng-container>
                                                                        <ng-template #editTemplate>
                                                                            <td>{{ data.id }} </td>
                                                                            <td>
                                                                                {{ data.customerName }}
                                                                            </td>
                                                                            <td>
                                                                                <div class="input-group">
                                                                                    <input type="number"
                                                                                        class="form-control"
                                                                                        [(ngModel)]="editCache[data.id].data.amount"
                                                                                        [ngModelOptions]="{ standalone: true }"
                                                                                        (input)="changeAmount(data.id)"
                                                                                        numbersOnly
                                                                                        aria-describedby="basic-addon1">
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <div class="input-group">
                                                                                    <input type="date"
                                                                                        class="form-control"
                                                                                        [(ngModel)]="editCache[data.id].data.dueDate"
                                                                                        [ngModelOptions]="{ standalone: true }"
                                                                                        aria-describedby="basic-addon1">
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <button
                                                                                    class="btn generating-status">{{"Promissory_Notes.Generating"|
                                                                                    translate}}</button>
                                                                            </td>
                                                                            <td>
                                                                                <a class="table-correct"
                                                                                    (click)="saveEdit(data.id)">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                        width="32" height="32"
                                                                                        viewBox="0 0 24 24">
                                                                                        <path fill="#29a073"
                                                                                            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5l1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" />
                                                                                    </svg>
                                                                                </a>
                                                                                <a class="table-cancel"
                                                                                    (click)="this.editCache[data.id].edit = false">
                                                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                                                        width="32" height="32"
                                                                                        viewBox="0 0 16 16">
                                                                                        <g fill="none" stroke="red"
                                                                                            stroke-linecap="round"
                                                                                            stroke-linejoin="round"
                                                                                            stroke-width="1.5">
                                                                                            <path
                                                                                                d="m10.25 5.75l-4.5 4.5m0-4.5l4.5 4.5" />
                                                                                            <circle cx="8" cy="8"
                                                                                                r="6.25" />
                                                                                        </g>
                                                                                    </svg>
                                                                                </a>
                                                                            </td>
                                                                        </ng-template>
                                                                    </tr>
                                                                </tbody>
                                                            </nz-table>
                                                        </div>
                                                    </div>
                                                    <div  *ngIf="current == 1 || current == 2 || current == 3 || current == 4|| current == 5">
                                                        <div class="row heading-box mt-4 pt-4">
                                                            <div class="col-lg-6">
                                                                <h1 class="head-title ">
                                                                    {{"Promissory_Notes.List_Of_Promissory_Notes" |
                                                                    translate}}
                                                                </h1>
                                                            </div>
                                                            <div class="col-lg-6 text-end">
                                                                <h1 class="head-title ">
                                                                    {{"Promissory_Notes.PN_BOOK_NO" |
                                                                    translate}} :
                                                                  <span  *ngIf="generatedlist.length  > 0 "  class="head-detail">{{generatedlist[0].pnBookID}}</span>
                                                                </h1>
                                                            </div>
                                                            <div class="row heading-box">
                                                                <div class="col-lg-5 col-md-6">
                                                                    <div class="card-box">
                                                                        <h4 class="head-title">
                                                                            {{"Promissory_Notes.Promissory_Notes_Total_Amount"
                                                                            |
                                                                            translate}}:
                                                                            <span class="head-detail">15,000</span>
                                                                        </h4>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-2 col-md-6">
                                                                    <div class="card-box">
                                                                        <h4 class="head-title">
                                                                            {{"Promissory_Notes.No" |
                                                                            translate}}:
                                                                            <span class="head-detail">10 PN</span>
                                                                        </h4>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-3 col-md-6">
                                                                    <div class="card-box">
                                                                        <h4 class="head-title">
                                                                            {{"Promissory_Notes.Remaining_Amount" |
                                                                            translate}}:
                                                                            <span class="head-detail">150</span>
                                                                        </h4>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-2 col-md-6">
                                                                    <div class="card-box">
                                                                        <h4 class="head-title">
                                                                            {{"Promissory_Notes.No" |
                                                                            translate}}:
                                                                            <span class="head-detail">10 PN</span>
                                                                        </h4>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="table-responsive">

                                                            <nz-table #editRowTable nzBordered [nzData]="generatedlist"
                                                                nzTableLayout="fixed" [nzPageSize]="6">
                                                                <thead>
                                                                    <tr>
                                                                        <th>
                                                                            {{"Promissory_Notes.No" | translate}}
                                                                        </th>
                                                                        <th>{{"Promissory_Notes.Customer_Name" |
                                                                            translate}}
                                                                        </th>
                                                                        <th  >
                                                                            {{"Promissory_Notes.Amount" | translate}}
                                                                        </th>
                                                                        <th  >
                                                                            {{"Promissory_Notes.Due_Date" | translate}}
                                                                        </th>
                                                                        <th  >
                                                                            {{"Promissory_Notes.PN_Status" | translate}}
                                                                        </th>
                                                                        <th>{{"Promissory_Notes.Action" | translate}}
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <ng-container *ngFor="let data of editRowTable.data;let index = index">
                                                                        <tr [ngClass]="{'hightlight-row': data.status.toLowerCase() == 'uncollected' &&  current == 4 && data.dateCheck == true}" >
                                                                        <td>
                                                                            {{ data.id }}
                                                                        </td>
                                                                        <td>{{ data.customerName }}</td>
                                                                        <td >{{ data.amount | customRound: 0 }} JD</td>
                                                                        <td>
                                                                            {{data.dueDate | date : 'dd MMM yyyy'}}
                                                                        </td>
                                                                        <td>

                                                                            <button  class="btn generating-status"  [style.color]="data.lookupTextColor"
                                                                             [style.background-color]="data.lookupBGColor">{{data.status}}</button>
                                                                        </td>
                                                                        <td>
                                                                            <a class="pen-icon" (click)="pdfView(data.pdfView,data)">
                                                                                <svg xmlns="http://www.w3.org/2000/svg"
                                                                                    width="24" height="24"
                                                                                    viewBox="0 0 24 24"
                                                                                    style="color: rgb(168 168 168)">
                                                                                    <path fill="currentColor"
                                                                                        d="M12 9a3 3 0 0 1 3 3a3 3 0 0 1-3 3a3 3 0 0 1-3-3a3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5c-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0a9.821 9.821 0 0 0-17.64 0Z" />
                                                                                </svg>
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                    </ng-container>
                                                                   
                                                                </tbody>
                                                            </nz-table>
                                                        </div>
                                                    </div>
                                                    <div class="bottom-buttons" *ngIf="current == 0">
                                                        <button type="button" class="btn btn-white hvr-bounce-to-right2"
                                                        [routerLink]="['/home/workorders']">Close</button>
                                                        <button class="btn o-btn hvr-bounce-to-right" type="button"
                                                            (click)="saveGeneratingNotes()"
                                                            [ngClass]="{'disabled':differenceAmount != 0}">Confirm</button>
                                                    </div>
                                                    <div class="bottom-buttons" *ngIf="current == 1">
                                                        <button type="button" [routerLink]="['/home/workorders']"
                                                            class="btn btn-white hvr-bounce-to-right2">Close</button>
                                                        <button class="btn o-btn hvr-bounce-to-right"
                                                            type="button" (click)="printPNBook()">Print PN
                                                            Book</button>
                                                    </div>
                                                    <div class="bottom-buttons" *ngIf="current == 2">
                                                        <button type="button" [routerLink]="['/home/workorders']"
                                                            class="btn btn-white hvr-bounce-to-right2">Close</button>
                                                        <button class="btn o-btn btn-white hvr-bounce-to-right"
                                                            type="button" (click)="printPNBook()">RePrint PN
                                                            Book</button>
                                                        <button class="btn o-btn hvr-bounce-to-right" type="button" (click)="printAll(19003)">Mark
                                                            As
                                                            Signed</button>
                                                    </div>
                                                    <div class="bottom-buttons" *ngIf="current == 3 || current == 4 || current == 5">
                                                        <button class="btn o-btn btn-white hvr-bounce-to-right" (click)="createRequest()"
                                                        [disabled]="current == 5 ? true : false"  type="button">Create
                                                            Request</button>
                                                        <button class="btn o-btn hvr-bounce-to-right"
                                                            type="button">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </nz-spin>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nz-tab>
        </nz-tabset>
    </div>
    <div *ngIf="isPrintShow">
        <div class="row heading-box p-4">
            <div class="col-lg-6 ">
                <h1 class="header-content ">
                    {{"Promissory_Notes.List_Of_Promissory_Notes" |
                    translate}}
                </h1>

            </div>
            <div class="col-lg-6 text-end">
                <h1 class="header-content ">
                    {{"Promissory_Notes.Difference_amount" |
                    translate}} (JD) : <span
                        class="head-detail" *ngIf="generatedlist.length  > 0 ">{{generatedlist[0].pnBookID}}</span>
                </h1>
            </div>
        </div>
        <embed [src]="safeUrl" *ngIf="safeUrl" type="application/pdf" width="100%" height="600px">
            <div class="row">
            <div class="col-lg-7"></div>    
            <div class="col-lg-4">
                <div class="bottom-buttons" >
                    <button type="button"
                        class="btn btn-white hvr-bounce-to-right2" (click)="printClose()">Close</button>
                    <button class="btn o-btn hvr-bounce-to-right"
                        type="button" (click)="printAll(19002)">Print All</button>
                </div>
            </div>    
            <div class="col-lg-1"></div>    

            </div>
          
    </div>
</nz-spin>

<nz-modal [(nzVisible)]="isVisible"  (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
  <ng-container *nzModalContent>
    <p *ngFor="let item of errorsList" class="text-center text-danger">{{item?.ErrorMessageEn}}</p>
  </ng-container>
</nz-modal>
